<?xml version="1.0" encoding="utf-8" ?>
<!---
Compile this xml into .c file with poconfig tool :
../../Lib/bin/poconfig.exe pusopen_onboard_mdb.xml pusopen_onboard_mdb.c
-->
<PusopenConfig>

  <!-- Version of the PUSopen(R) configuration scheme (this XML). Please do not change. -->
  <PoCfgVersion>1.1</PoCfgVersion>

  <!-- Application Process ID (APID) -->
  <Apid>1</Apid>
  
  <!-- Application Process User ID (APUID) -->
  <Apuid>2</Apuid>
  
  <!-- Configuration of the PUSopen(R) PUS services, Packet Services, Virtual Channels and FESS module -->
  <Modules>

    <!-- PUS Service 1 provider. -->
    <Pus1>
      <Used>true</Used>

      <!-- PUS Service 1 reception buffer. This buffer shall be large enough to accommodate 
           largest expected TM/TC with its associated data. Only one TM/TC is stored in this
           buffer at any time. -->
      <RecvBufferSize>2048</RecvBufferSize> <!-- ComBuffer is 1102 length : FW_COM_BUFFER_MAX_SIZE + sizeof(FwBuffSizeType) -->
    </Pus1>
        
    <Pus3>
      <Used>true</Used>

      <!-- Size of buffer used to assemble TM[3,26] ([3, 25] ? ) report (in bytes) -->
      <ReportBufferSize>512</ReportBufferSize> <!-- @todo Check with ComBuffer (TlmPacket) size ? -->
    </Pus3>

    <Pus5>
      <Used>true</Used>
    </Pus5>

    <Pus8>
      <Used>true</Used>
    </Pus8>
    
    <Pus13>
      <Used>false</Used>
    </Pus13>
    
    <Pus17>
      <Used>true</Used>
    </Pus17>

    <PusUsr>
      <Used>false</Used>
    </PusUsr>
       
    <Ps>
      <!-- Packet Services used flag (values: "true" or "false") -->
      <Used>true</Used>
      
      <!-- Max size of sent/received packet (in bytes). Values: 0 to 16000 -->
      <!-- PO_ERR_TOOLONG 11 - Data too long if smaller than PusEvent DataSize -->
      <MaxSendPacketSize>2048</MaxSendPacketSize>   
      <MaxRecvPacketSize>2048</MaxRecvPacketSize>   
      
      <!-- Idle packet: byte value used to fill an idle packet and size of packet -->
    </Ps>


    <!-- Virtual Channel Services -->
    <Vcs>
      <Used>false</Used>
    </Vcs>

    <Fess>
      <!-- Frame Encoding and Synchronization Service. Used: true / false. -->
      <Used>true</Used>

      <!-- Size of the send/receive buffer holding raw byte stream (in bytes). 
           This buffer should be large enough to accommodate at least one
           full packet or frame. -->
      <SendBufferSize>4096</SendBufferSize>
      <RecvBufferSize>4096</RecvBufferSize>

      <!-- Size of internal buffer of FESS (in bytes). There are four buffers of this
           size and they shall be large enough to accommodate encrypted packet/frame. -->
      <TempBufferSize>4096</TempBufferSize>
      
      <!-- Attached Synchronization Mark (ASM) content and length. 
           A byte field (uint8_t[]) defining content of ASM. 
           PUSopen pre-defines FESS_DEF_ASM = {0,0,0}. -->
      <Asm>FESS_DEF_ASM</Asm>
      <AsmLen>3</AsmLen>
      
      <!-- Encoding/encryption algorithms used.
           
           Encoding:
               SLIP = Serial Line Internet Protocol
               NOENCODING = no specific encoding will be performed.

           Encryption:
               AES128 = AES-128 encryption with key defined in the mission database
               NOENCRYPTION = no encryption used

           NOTE: If no encoding is used, user has to implement his own packet delimiting mechanism. -->

      <EncodingAlgorithm>SLIP</EncodingAlgorithm>
      <EncryptionAlgorithm>NOENCRYPTION</EncryptionAlgorithm>
    </Fess>
  </Modules>


  <!-- PUS 5 on-board events -->
  <Events>
    <!-- Please add one "<PusEvent>" element for every TM[5,x] event defined. 
         * Each PUS event is identified by user-defined Id. Id don't have to be in 
           sequential order.
         * Event level is one of the following values:
         
             PUS5_EVT_INFO   = Information event TM[5,1]
             PUS5_EVT_LOW    = Low severity anomaly TM[5,2]
             PUS5_EVT_MEDIUM = Medium severity anomaly TM[5,3]
             PUS5_EVT_HIGH   = High severity anomaly TM[5,4]
             
         * DataSize element defines size of data payload associated 
           with event. User defines data content for each occurrence
           of the event.
     
         Example event:
    
         <PusEvent>
            <Id>1</Id>
            <Level>PUS5_EVT_INFO</Level>
            <Description>Informative event</Description>
            <DataSize>150</DataSize>
            <VcId>1</VcId>
         </PusEvent>
    -->
    <PusEvent>
       <Id>1</Id>
       <Level>PUS5_EVT_INFO</Level>
       <Description>Information event</Description>
       <DataSize>1</DataSize> <!-- 1102 for ComBuffer -->
    </PusEvent>

    <PusEvent>
       <Id>2</Id>
       <Level>PUS5_EVT_LOW</Level>
       <Description>Low severity anomaly</Description>
       <DataSize>1</DataSize> <!-- 1102 for ComBuffer -->
    </PusEvent>

    <PusEvent>
       <Id>3</Id>
       <Level>PUS5_EVT_MEDIUM</Level>
       <Description>Medium severity anomaly</Description>
       <DataSize>1</DataSize> <!-- 1102 for ComBuffer -->
    </PusEvent>

    <PusEvent>
       <Id>4</Id>
       <Level>PUS5_EVT_HIGH</Level>
       <Description>High severity anomaly</Description>
       <DataSize>1</DataSize> <!-- 1102 for ComBuffer -->
    </PusEvent>
  </Events>

  <!-- Declaration of user function called by PUS 8 -->
  <UserCode>
extern po_result_t UserPus8Fn(uint8_t fid, uint8_t *data, uint16_t len);
extern uint32_t PR_NumPings;
  </UserCode>

  <!-- PUS 8 user functions -->
  <UserFunctions>
    <UsrFunc>
      <Id>1</Id>
      <Name>Test function</Name>
      <Description>Example test function</Description>
      <Addr>UserPus8Fn</Addr>
    </UsrFunc>
  </UserFunctions>
    
  <HkParameters>
    <HkParam>
      <Id>100</Id>
      <Name>PR_NumPings</Name>
      <Description>Number of pings received</Description>
      <Type>PO_UINT32</Type>
      <Addr>PR_NumPings</Addr>
    </HkParam>
  </HkParameters>
 
  <HkReports>
    <HkReport>
      <Id>1</Id>
      <Name>Report #1</Name>
      <Description>Report #1 description</Description>
      <Enabled>true</Enabled>
      <Interval>1</Interval>
      <DestApid>3</DestApid>
      <!-- <VcId>1</VcId> -->
      <HkParamsList>
        <HkParamId>100</HkParamId>
      </HkParamsList>
    </HkReport>
  </HkReports>
  
</PusopenConfig>  <!-- End of PUSopen(R) Mission Database -->